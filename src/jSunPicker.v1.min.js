!function(t){function e(e,i,n){this.element=t(e);var s=this.element.data();this.picker=t("<div class='jsunpicker' />"),this.options=t.extend({language:"en-US",daysTitle:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthsTitle:["January","February","March","April","May","June","July","August","September","October","November","December"],dayShort:2,monthShort:3,showIcon:null,inline:null,startDay:1,pickerType:"date",displayFormat:"W, T d, Y H:N:S A",outputFormat:"U",minDate:null,maxDate:null,minTime:null,maxTime:null,disabledDays:null,disabledDates:null,initialDate:null,onShow:t.noop,onClose:t.noop,onSelect:t.noop},n,s),this.pickerElement=this.pickerElement(),this.pickerInit=this.pickerElement.initElement,this.clone=this.pickerElement.clone,null!==this.options.initialDate&&(this.initialDate=this.options.initialDate,this.select(this.initialDate)),this.options.inline?(this.render(this.options.pickerType,this.initialDate),this.picker.css({display:"inline-block",position:"relative","z-index":"100"}),t(this.options.inline).append(this.picker)):(this.element.after(this.picker),this.picker.css(this.pickerPosition(this.pickerInit))),this.pickerInit.click(t.proxy(function(){null==this.options.inline?this.picker.toggle():"",this.render(this.options.pickerType,this.element.attr("data-selected-value"))},this)),this.clone.change(t.proxy(function(){var t=this.formatDate(this.clone.val(),"Y/M/D H:N:S");this.select(t),this.render(this.options.pickerType,t)},this)),this.picker.on("click",".prevButton, .titleButton, .nextButton",t.proxy(function(e){var i=t(e.currentTarget);i.data("view")&&i.data("nav")?this.render(i.data("view"),i.data("nav")):""},this)),this.picker.on("click",".year, .month",t.proxy(function(e){var i=t(e.currentTarget);if("datetime"==this.options.pickerType)i.data("view")&&i.data("nav")?this.render(i.data("view"),i.data("nav")):"";else if(!i.hasClass("disabled")){i.addClass("selected").siblings().removeClass("selected");var n=i.data("nav");this.select(n),this.picker.hide()}},this)),this.picker.on("click",".day, .otherday, .fav",t.proxy(function(e){var i=t(e.currentTarget);if(!i.hasClass("disabled")){i.addClass("selected").siblings().removeClass("selected");var n=i.data("nav");this.select(n),"datetime"==this.options.pickerType?this.render("time",n):null==this.options.inline?this.picker.hide():this.render(this.options.pickerType,n)}},this)),this.picker.on("change",".time",t.proxy(function(e){var i=t(e.currentTarget),n=i.find(".error"),s=i.find(".timeButton"),a=i.find(".hour").val()+":"+i.find(".min").val()+":"+i.find(".sec").val()+" "+(i.find(".ampm").is(":checked")?"PM":"AM");this.minMax(s.data("date")+a,s.data("date")+this.options.minTime,s.data("date")+this.options.maxTime)?n.html("Invalid Time"):n.html(""),s.data("nav",s.data("date")+a).val(a).text(a)},this)),this.picker.on("click",".timeButton",t.proxy(function(e){var i=t(e.currentTarget);e.preventDefault();var n=this.minMax(i.data("nav"),i.data("date")+this.options.minTime,i.data("date")+this.options.maxTime);-1==["datetime","time"].indexOf(this.options.pickerType)||n||(this.element.val(this.formatDate(i.data("nav"),this.options.outputFormat)),this.clone.val(this.formatDate(i.data("nav"),this.options.displayFormat)),null==this.options.inline?this.picker.hide():"datetime"==this.options.pickerType?this.render("date",i.data("nav")):"")},this))}t.fn.jSunPicker=function(t){return this.each(function(i){new e(this,i,t)})},e.prototype={dateComponents:function(t){var e=t&&Date.parse(t.replace(/-/g,"/"))?new Date(Date.parse(t.replace(/-/g,"/"))):new Date,i={year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()};return i},dateRange:function(t){var e=[],n=t.split(",");for(i=0;i<n.length;i++)if(n[i].search("-")>=0)for(var s=n[i].split("-"),a=new Date(s[0]),r=new Date(s[1]);r>=a;)e.push(a.valueOf()),a=new Date(a.setDate(a.getDate()+1));else e.push(new Date(n[i]).valueOf());return e},minMax:function(t,e,i){var n=!1;return t&&null!==e&&(n=new Date(t)-new Date(e)<0),t&&null!==i&&!n&&(n=new Date(t)-new Date(i)>0),n},select:function(e){this.element.attr("data-selected-Value",e).val(this.formatDate(e,this.options.outputFormat)),this.clone.val(this.formatDate(e,this.options.displayFormat)),t.isFunction(this.options.onSelect)&&this.options.onSelect(e)},destroy:function(){this.picker&&(this.picker.remove(),this.picker=null,t.isFunction(this.options.onClose)&&this.options.onClose())},render:function(e,i){this.picker.html(this.renderCalendar(e,i)),t.isFunction(this.options.onShow)&&this.options.onShow()},pickerElement:function(){return this.clone=this.element.clone().removeAttr("name").attr("autocomplete","off").attr("id",this.element.attr("id")+"_clone"),this.element.after(this.clone),null!=this.options.showIcon?this.clone.after(this.initElement=t("<span class='calendarButton'><img src='"+this.options.showIcon+"' /></span>")):this.initElement=this.clone,this.element.hide(),pickerElement={initElement:this.initElement,clone:this.clone,original:this.element}},pickerPosition:function(){var e,i=this.clone,n={left:i.offset().left,top:i.offset().top},s=this.picker.outerHeight(),a=Math.abs(t(window).height()-n.top+i.outerHeight());n.top+t(window).scrollTop();return e=a>s?{"margin-top":i.outerHeight()+2}:{"margin-top":-1*this.picker.outerHeight()-3}},leadZero:function(t){return 10>t?"0"+t:t},formatDate:function(t,e){var i,n=this.dateComponents(t),s={d:n.date,D:this.leadZero(n.date),m:n.month+1,M:this.leadZero(n.month+1),t:this.options.monthsTitle[n.month].substring(0,this.options.monthShort),T:this.options.monthsTitle[n.month],y:n.year.toString().substring(2,2),Y:n.year,w:this.options.daysTitle[n.day].substring(0,this.options.dayShort),W:this.options.daysTitle[n.day],h:e.match(/a/gi)?n.hours%12?n.hours%12:12:n.hours,H:e.match(/a/gi)?this.leadZero(n.hours%12?n.hours%12:12):this.leadZero(n.hours),n:n.minutes,N:this.leadZero(n.minutes),s:n.seconds,S:this.leadZero(n.seconds),a:n.hours>11?"pm":"am",A:n.hours>11?"PM":"AM"},a=new RegExp(Object.keys(s).join("|"),"g");switch(e){case"U":i=Date.UTC(n.year,n.month,n.date,n.hours,n.minutes,n.seconds);break;case"X":i="HN".replace(a,function(t){return s[t]});break;default:i=e.replace(a,function(t){return s[t]})}return i},renderTitle:function(t,e){var i="";-1==["datetime","date"].indexOf(this.options.pickerType)?e=this.options.pickerType:i=this.selectedDate||this.currentYear+"/01/01";var n="<div class='title titleButton' data-nav = '"+i+"' data-view = '"+e+"'> "+t+" </div><div class='fav favButton' data-nav = '"+this.defaultValue+"' data-view = '"+e+"'> &hearts; </div>";return n},renderPrevious:function(t,e){var i="<div class='title prevButton' data-nav = '"+t+"' data-view = '"+e+"'>&lt;</div>";return i},renderNext:function(t,e){var i="<div class='title nextButton' data-nav = '"+t+"' data-view = '"+e+"'>&gt;</div>";return i},renderMonth:function(){var e,n,s,a,r=new Date(this.currentYear,this.currentMonth,1),o=new Date(this.currentYear,this.currentMonth+1,0),h=new Date(this.currentYear,this.currentMonth,0).getDate(),l=r.getDay(),d=o.getDay(),c=this.options.monthsTitle[this.currentMonth]+" "+this.currentYear;switch(n=null!==this.options.disabledDates?this.dateRange(this.options.disabledDates):[],e=null!==this.options.disabledDays?this.options.disabledDays.split(","):[],this.currentMonth){case 0:s=this.currentYear-1+"/12/1",a=this.currentYear+"/"+(this.currentMonth+2)+"/1";break;case 11:s=this.currentYear+"/"+this.currentMonth+"/1",a=this.currentYear+1+"/1/1";break;default:s=this.currentYear+"/"+this.currentMonth+"/1",a=this.currentYear+"/"+(this.currentMonth+2)+"/1"}var u=this.renderPrevious(s,this.currentView)+this.renderTitle(c,"month")+this.renderNext(a,this.currentView);for(i=this.options.startDay-1;i<this.options.startDay+6;i++)u+="<div class='title'>"+this.options.daysTitle[i%7].substring(0,this.options.dayShort)+"</div>";if(l-(this.options.startDay-1)!==0)for(k=(l-this.options.startDay+7)%7;k>=0;k--){var p=h-k,v=Math.abs((k-l)%7);D=this.currentMonth?this.currentYear+"/"+this.currentMonth+"/"+p:this.currentYear-1+"/12/"+p,f=this.minMax(D,this.options.minDate,this.options.maxDate)?"disabled":t.inArray(new Date(D).valueOf(),n)>-1||t.inArray(v+"",e)>-1?"disabled":"",u+="<div class='otherday day"+v+" "+f+"' data-nav = '"+D+"'>"+p+"</div>"}for(j=1;j<=o.getDate();j++){var y="",v=Math.abs((j+l)%7)||"7";D=this.currentYear+"/"+(this.currentMonth+1)+"/"+j;var f=this.minMax(D,this.options.minDate,this.options.maxDate)?"disabled":t.inArray(new Date(D).valueOf(),n)>-1||t.inArray(v+"",e)>-1?"disabled":"";y=j==this.currentDate?"selected":"",u+="<div class='day day"+v+" "+y+" "+f+"' data-nav = '"+D+"'>"+j+"</div>"}for(m=1;m<=42-o.getDate()-(l-this.options.startDay+1+7)%7;m++){var v=Math.abs((m+d+1+7)%7)||"7",D="11"==this.currentMonth?this.currentYear+1+"/1/"+m:this.currentYear+"/"+(this.currentMonth+2)+"/"+m,f=this.minMax(D,this.options.minDate,this.options.maxDate)||t.inArray(new Date(D).valueOf(),n)>=0||t.inArray(v+"",e)>-1?"disabled":"";u+="<div class='otherday day"+v+" "+f+"' data-nav = '"+D+"'>"+m+"</div>"}this.currentDate+" "+this.options.monthsTitle[this.currentMonth].substring(0,this.options.monthShort)+" "+this.currentYear;return u},renderYear:function(){var t,e=this.currentYear-1+"/01/01",n=this.currentYear+1+"/01/01",s=this.renderPrevious(e,this.currentView)+this.renderTitle(this.currentYear,"year")+this.renderNext(n,this.currentView);for(i=0;i<12;i++){var a=this.currentYear+"/"+(i+1)+"/1";t=i==this.currentMonth?"selected":"",s+="<div class='month "+t+"' data-view = 'date' data-nav = '"+a+"'>"+this.options.monthsTitle[i].substring(0,this.options.monthShort)+"</div>"}return s},renderDecade:function(){var t,e=this.currentYear-this.currentYear%20,n=e-20+"/01/01",s=e+20+"/01/01",a=e+" - "+(e+19),r=this.renderPrevious(n,this.currentView)+this.renderTitle(a,"decade")+this.renderNext(s,this.currentView);for(i=0;i<20;i++){var o=e+i+"/1/1";t=e+i==this.currentYear?"selected":"",r+="<div class='year "+t+"' data-view = 'month' data-nav = '"+o+"'>"+(e+i)+"</div>"}return r},renderTime:function(){var t=this.options.monthsTitle[this.currentMonth]+" "+this.currentDate+", "+this.currentYear,e=this.renderPrevious("",this.currentView)+this.renderTitle(t,"date")+this.renderNext("",this.currentView),i="",n=new Date,s=new Date(this.selectedDate||n),a=n.getHours()>12?(n.getHours()-12<10?"0":"")+(n.getHours()-12):(n.getHours()<10&&n.getHours()>0?"0":"")+(n.getHours()||12),r=(n.getMinutes()<10?"0":"")+n.getMinutes(),o=(n.getSeconds()<10?"0":"")+n.getSeconds(),h=n.getHours()<12?"AM ":"PM",l=s.getFullYear()+"/"+(s.getMonth()+1)+"/"+s.getDate()+" ",d=a+":"+r+":"+o+" "+h;n.getHours()>12?i="checked":"";var c=this.minMax(l+d,l+this.options.minTime,l+this.options.maxTime)?"Invalid Time":"";return e+="<div class='time'><span class='error'>"+c+"</span><div><input type='number' min='1' max='12' step='1' class='hour' value='"+a+"' /><label>:</label><input type='number' min='0' max='59'  step='1' class='min' value='"+r+"' /><label>:</label><input type='number' min='0' max='59' step='1' class='sec' value='"+o+"' /></div><p><input type='checkbox' class='ampm' value='pm' "+i+">PM</input></p>",e+="<p><button class='timeButton' data-view = 'time' data-date = '"+l+" ' data-nav = '"+l+d+"'>"+d+"</button></p></div>"},renderCalendar:function(e,i){this.selectedDate=i;var n,s=this.dateComponents(i);n=this.options.disabledDays?this.options.disabledDays.split(","):[],this.defaultDate=new Date,this.defaultValue=this.defaultDate.getFullYear()+"/"+(this.defaultDate.getMonth()+1)+"/"+this.defaultDate.getDate(),this.currentDate=s.date,this.currentView=e,this.currentYear=s.year,this.currentMonth=s.month;var a=t.proxy(function(){switch(this.currentView){default:case"datetime":return this.renderMonth();case"date":return this.renderMonth();case"month":return this.renderYear();case"year":return this.renderDecade();case"time":return this.renderTime()}},this);return a}}}(jQuery);
